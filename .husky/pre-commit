#!/bin/sh
set -e

if git diff --cached --name-only | grep -qiE '\.(env|env\.)'; then
  echo "[31mâœ– Refusing to commit environment files (.env*)[0m" >&2
  exit 1
fi

if git diff --cached --color=never | grep -Ei 'AWS_SECRET|API_KEY|BEGIN RSA|PRIVATE KEY|NEXTAUTH_SECRET'; then
  echo "[31mâœ– Potential secret detected in staged changes[0m" >&2
  exit 1
fi

exit 0
